    
<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Indicadores</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="logo">XPTO</div>
        <nav>
          <a href="index.html">Cadastro</a>
          <a href="indicadores.html" class="active">Indicadores</a>
          <a href="pessoas.html">Pessoas</a>
          <a href="import.html">Importar</a>
          <a href="export.html">Exportar</a>
        </nav>
      </aside>
      <main class="content">
        <div class="topbar">
          <div><h1 style="margin:0;font-size:1.25rem;">Indicadores Gerais</h1></div>
          <div></div>
        </div>
        <div class="indicadores-cards">
          <div class="indicador-card card">
            <div class="indicador-icon" title="Pessoas">üë§</div>
            <div class="indicador-num" id="totalPessoas">0</div>
            <div class="indicador-label">Pessoas</div>
          </div>
          <div class="indicador-card card">
            <div class="indicador-icon" title="Eventos">üìÖ</div>
            <div class="indicador-num" id="totalEventos">0</div>
            <div class="indicador-label">Eventos</div>
          </div>
          <div class="indicador-card card">
            <div class="indicador-icon" title="Rela√ß√µes">üîó</div>
            <div class="indicador-num" id="totalRelacoes">0</div>
            <div class="indicador-label">Rela√ß√µes</div>
          </div>
          <div id="relationTypeCards" style="display:flex;gap:12px;flex-wrap:wrap;align-items:stretch;"></div>
          <div id="eventTypeCards" style="display:flex;gap:12px;flex-wrap:wrap;align-items:stretch;margin-top:6px;"></div>
          <div id="genderCards" style="display:flex;gap:12px;flex-wrap:wrap;align-items:stretch;margin-top:6px;"></div>
        </div>
      </main>
    </div>
    <script>
      function getPeople() {
        try {
          const raw = localStorage.getItem('people:xpto');
          return raw ? JSON.parse(raw) : [];
        } catch (e) { return []; }
      }
      function getEvents() {
        try {
          const raw = localStorage.getItem('events:xpto');
          return raw ? JSON.parse(raw) : [];
        } catch (e) { return []; }
      }
      function getRelations() {
        try {
          const raw = localStorage.getItem('relations:xpto');
          return raw ? JSON.parse(raw) : [];
        } catch (e) { return []; }
      }
      function updateIndicadores() {
        const pessoas = getPeople().filter(p => !p.deletedAt);
        const eventos = getEvents().filter(ev => !ev.deletedAt);
        const relacoes = getRelations();
        document.getElementById('totalPessoas').textContent = pessoas.length;
        document.getElementById('totalEventos').textContent = eventos.length;
        document.getElementById('totalRelacoes').textContent = relacoes.length;
        // Contagem por tipo de rela√ß√£o e renderiza√ß√£o de cards espec√≠ficos
        const typeMap = {
          siblin: { label: 'Irm√£o / Irm√£', icon: 'üßë‚Äçü§ù‚Äçüßë' },
          ancestor: { label: 'Pai / M√£e', icon: 'üë™' },
          child: { label: 'Filho(a)', icon: 'üßí' },
          mate: { label: 'Companheiro(a)', icon: 'üíû' }
        };
        const counts = {};
        relacoes.forEach(r => { if (r && r.type) counts[r.type] = (counts[r.type] || 0) + 1; });
        const container = document.getElementById('relationTypeCards');
        if (container) {
          container.innerHTML = '';
          // Render known types in a stable order
          Object.keys(typeMap).forEach(t => {
            const n = counts[t] || 0;
            const card = document.createElement('div');
            card.className = 'indicador-card card';
            card.style.minWidth = '140px';
            card.innerHTML = `<div class="indicador-icon" title="${typeMap[t].label}">${typeMap[t].icon}</div><div class="indicador-num">${n}</div><div class="indicador-label">${typeMap[t].label}</div>`;
            container.appendChild(card);
            // remove from counts so remaining unknowns can be listed later
            delete counts[t];
          });
          // Render any unknown types that exist in data
          Object.keys(counts).forEach(t => {
            const n = counts[t] || 0;
            const card = document.createElement('div');
            card.className = 'indicador-card card';
            card.style.minWidth = '140px';
            card.innerHTML = `<div class="indicador-icon" title="${t}">üî∏</div><div class="indicador-num">${n}</div><div class="indicador-label">${t}</div>`;
            container.appendChild(card);
          });
        }
        // Eventos: contar por tipo e renderizar cards
        const eventMap = {
          BIRTH: { label: 'Nascimento', icon: 'üë∂' },
          BAPTISM: { label: 'Batismo', icon: '‚úùÔ∏è' },
          DEATH: { label: '√ìbito', icon: 'ü™¶' },
          MARRIAGE: { label: 'Casamento', icon: 'üíç' },
          DIVORCE: { label: 'Div√≥rcio', icon: '‚öñÔ∏è' },
          ADOPTION: { label: 'Ado√ß√£o', icon: 'ü§ù' },
          CUSTOM: { label: 'Outro', icon: 'üî∏' }
        };
        const evCounts = {};
        eventos.forEach(ev => { if (ev && ev.type) evCounts[ev.type] = (evCounts[ev.type] || 0) + 1; });
        const evContainer = document.getElementById('eventTypeCards');
        if (evContainer) {
          evContainer.innerHTML = '';
          Object.keys(eventMap).forEach(t => {
            const n = evCounts[t] || 0;
            const card = document.createElement('div');
            card.className = 'indicador-card card';
            card.style.minWidth = '140px';
            card.innerHTML = `<div class="indicador-icon" title="${eventMap[t].label}">${eventMap[t].icon}</div><div class="indicador-num">${n}</div><div class="indicador-label">${eventMap[t].label}</div>`;
            evContainer.appendChild(card);
            delete evCounts[t];
          });
          // Render any unknown event types
          Object.keys(evCounts).forEach(t => {
            const n = evCounts[t] || 0;
            const card = document.createElement('div');
            card.className = 'indicador-card card';
            card.style.minWidth = '140px';
            card.innerHTML = `<div class="indicador-icon" title="${t}">üîπ</div><div class="indicador-num">${n}</div><div class="indicador-label">${t}</div>`;
            evContainer.appendChild(card);
          });
        }
        // G√™neros: contar por g√™nero e renderizar cards
        const genderMap = {
          male: { label: 'Masculino', icon: '‚ôÇ' },
          female: { label: 'Feminino', icon: '‚ôÄ' },
          other: { label: 'Outro', icon: '‚öß' },
          unknown: { label: 'N√£o informado', icon: '‚ùì' }
        };
        const gCounts = {};
        pessoas.forEach(p => { const g = p && p.gender ? p.gender : 'unknown'; gCounts[g] = (gCounts[g] || 0) + 1; });
        const gContainer = document.getElementById('genderCards');
        if (gContainer) {
          gContainer.innerHTML = '';
          // Render known genders in stable order
          ['male','female','other','unknown'].forEach(k => {
            const n = gCounts[k] || 0;
            const info = genderMap[k] || { label: k, icon: '‚ùì' };
            const card = document.createElement('div');
            card.className = 'indicador-card card';
            card.style.minWidth = '140px';
            card.innerHTML = `<div class="indicador-icon" title="${info.label}">${info.icon}</div><div class="indicador-num">${n}</div><div class="indicador-label">${info.label}</div>`;
            gContainer.appendChild(card);
            delete gCounts[k];
          });
          // Any unexpected gender keys
          Object.keys(gCounts).forEach(k => {
            const n = gCounts[k] || 0;
            const card = document.createElement('div');
            card.className = 'indicador-card card';
            card.style.minWidth = '140px';
            card.innerHTML = `<div class="indicador-icon" title="${k}">üî∏</div><div class="indicador-num">${n}</div><div class="indicador-label">${k}</div>`;
            gContainer.appendChild(card);
          });
        }
      }
      updateIndicadores();
    </script>
  </body>
</html>
